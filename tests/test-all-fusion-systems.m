// AllFusionSystems
// Example that does pass MaxClassTest
F := AllFusionSystems(ExtraSpecialGroup(3,1));
assert #F eq 4; // Check correct number of fusion systems
assert IsIsomorphic(F[1]`group, ExtraSpecialGroup(3,1)); // Check group set correctly
print "AllFusionSystems test 1 passed";
FG := GroupFusionSystem(SL(3,3), 3); // Dependancy
flag := false;
for FS in F do 
	if IsIsomorphic(FS,FG) then // Dependancy
		flag := true;
	end if;
end for;
assert flag; // Check that the group fusion system was in there
print "AllFusionSystems test 2 passed"





// Legacy output
/*
**********************************************
 Borel 1 of 9 [ <3, 3> ]
**********************************************
**********************************************
 Borel 2 of 9 [ <2, 1>, <3, 3> ]
**********************************************
**********************************************
 Borel 3 of 9 [ <2, 1>, <3, 3> ]
**********************************************
**********************************************
 Borel 4 of 9 [ <2, 2>, <3, 3> ]
**********************************************
**********************************************
 Borel 5 of 9 [ <2, 2>, <3, 3> ]
**********************************************
**********************************************
 Borel 6 of 9 [ <2, 3>, <3, 3> ]
**********************************************
**********************************************
 Borel 7 of 9 [ <2, 3>, <3, 3> ]
**********************************************
**********************************************
 Borel 8 of 9 [ <2, 3>, <3, 3> ]
**********************************************
**********************************************
 Borel 9 of 9 [ <2, 4>, <3, 3> ]
**********************************************
[
    Fusion System with 2 F-classes of essential subgroups
    They have orders: [ 9, 9 ]Out_F(E)  have orders: [ 48, 48 ]
    Out_F(S) has order  4,
    Fusion System with 2 F-classes of essential subgroups
    They have orders: [ 9, 9 ]Out_F(E)  have orders: [ 48, 48 ]
    Out_F(S) has order  8,
    Fusion System with 1 F-classes of essential subgroups
    They have orders: [ 9 ]Out_F(E)  have orders: [ 48 ]
    Out_F(S) has order  8,
    Fusion System with 1 F-classes of essential subgroups
    They have orders: [ 9 ]Out_F(E)  have orders: [ 48 ]
    Out_F(S) has order  16
]
*/




// Example that triggers maximal class check
F := AllFusionSystems(ExtraSpecialGroup(5,1));
// We expect 3 fusion systems, all group fusion systems
// F_S(SL(3,5)), F_S(SL(3,5):2) and F_S(Th)
// All automisers are GL_2(5)
assert #F eq 3; // Check correct number of fusion systems


// Legacy output
/*
**********************************************
 Borel 1 of 30 [ <5, 3> ]
**********************************************
**********************************************
 Borel 2 of 30 [ <2, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 3 of 30 [ <2, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 4 of 30 [ <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 5 of 30 [ <2, 2>, <5, 3> ]
**********************************************
**********************************************
 Borel 6 of 30 [ <2, 2>, <5, 3> ]
**********************************************
**********************************************
 Borel 7 of 30 [ <2, 2>, <5, 3> ]
**********************************************
**********************************************
 Borel 8 of 30 [ <2, 2>, <5, 3> ]
**********************************************
**********************************************
 Borel 9 of 30 [ <2, 2>, <5, 3> ]
**********************************************
**********************************************
 Borel 10 of 30 [ <2, 1>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 11 of 30 [ <2, 1>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 12 of 30 [ <2, 3>, <5, 3> ]
**********************************************
**********************************************
 Borel 13 of 30 [ <2, 3>, <5, 3> ]
**********************************************
**********************************************
 Borel 14 of 30 [ <2, 3>, <5, 3> ]
**********************************************
**********************************************
 Borel 15 of 30 [ <2, 3>, <5, 3> ]
**********************************************
**********************************************
 Borel 16 of 30 [ <2, 3>, <5, 3> ]
**********************************************
**********************************************
 Borel 17 of 30 [ <2, 2>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 18 of 30 [ <2, 2>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 19 of 30 [ <2, 2>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 20 of 30 [ <2, 4>, <5, 3> ]
**********************************************
**********************************************
 Borel 21 of 30 [ <2, 4>, <5, 3> ]
**********************************************
**********************************************
 Borel 22 of 30 [ <2, 4>, <5, 3> ]
**********************************************
**********************************************
 Borel 23 of 30 [ <2, 3>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 24 of 30 [ <2, 3>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 25 of 30 [ <2, 3>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 26 of 30 [ <2, 3>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 27 of 30 [ <2, 5>, <5, 3> ]
**********************************************
**********************************************
 Borel 28 of 30 [ <2, 4>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 29 of 30 [ <2, 4>, <3, 1>, <5, 3> ]
**********************************************
**********************************************
 Borel 30 of 30 [ <2, 5>, <3, 1>, <5, 3> ]
**********************************************
[
    Fusion System with 2 F-classes of essential subgroups
    They have orders: [ 25, 25 ]Out_F(E)  have orders: [ 480, 480 ]
    Out_F(S) has order  16,
    Fusion System with 1 F-classes of essential subgroups
    They have orders: [ 25 ]Out_F(E)  have orders: [ 480 ]
    Out_F(S) has order  32,
    Fusion System with 1 F-classes of essential subgroups
    They have orders: [ 25 ]Out_F(E)  have orders: [ 480 ]
    Out_F(S) has order  96
]
*/







// GroupFusionSystem
// Trivial example
F := GroupFusionSystem(Sym(6), 3);
F;
// Legacy output
Fusion System with 0 F-classes of essential subgroups
They have orders: []Out_F(E)  have orders: []
Out_F(S) has order  8
This is a group fusion system



// GroupFusionSystem
// More complicated example
F := GroupFusionSystem(SL(3,3), 3);
F;
// Legacy output
Fusion System with 2 F-classes of essential subgroups
They have orders: [ 9, 9 ]Out_F(E)  have orders: [ 48, 48 ]
Out_F(S) has order  4
This is a group fusion system





// IsRadical
S := ExtraSpecialGroup(5,1);
P := AllSubgroups(S)[2];
if IsRadical(S,P) then
	print "IsRadical test passed";
end if;



